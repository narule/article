import{ay as a,a0 as e,a1 as l,a3 as t,bf as s,c as i,w as o,o as n,a as u,an as d,a8 as c,aa as r,ac as m,ah as v,ai as f,Z as p,bg as x,a9 as y,ad as b,ak as h,aj as _,ab as w,ag as g,ar as C,aq as k,bh as z,t as j,at as I,au as A}from"./index-DlrOOw1b.js";import{b as B,a as q,V as S,c as D,w as F}from"./wechat_logo-B2QabQW4.js";const T={style:{"font-size":"18px"}},U={style:{"font-size":"18px",color:"rgb(50,158,244)"}},E={class:"d-flex flex-wrap ma-2"},M={class:"d-flex align-center",style:{flex:"1"}},N={style:{"min-width":"100px"}},P={class:"sticky-order"},V={class:"mx-4 mb-8 text-h6 d-flex justify-space-between"},Z={style:{"font-size":"20px"}},G={class:"mx-4 mb-8 text-h6 d-flex justify-space-between"},H={style:{"font-size":"20px"}},J={key:0,class:"mx-4 mb-8 text-h6 d-flex justify-space-between"},K={style:{"font-size":"20px"}},L=a({__name:"product-pay",setup(a){e().fromPage="/product-pay";const L=[{label:"支付宝",value:"alipay",image:D},{label:"微信支付",value:"wechat",image:F}],O=l([]),Q=l({}),R=l("alipay"),W=l(!0),X=l(""),Y=l(null);function $(a){Q.value=a,X.value=a.id}async function aa(){const a=Q.value,e=await C({paymentMethod:R.value,orderName:a.name,items:[{productId:a.id,productCode:a.productCode,quantity:1}]});if(e.success){const a=k();l=e.data.order_id,Y.value=setInterval((async()=>{const a=await A(l);a.success&&"SUCCESS"===a.data&&(k().handleCancel(),clearInterval(Y.value),Y.value=null)}),5e3),"wechat"===R.value?a.showConfirmDialog({title:"扫码支付",message:"请使用微信扫码完成支付",confirmAction:()=>{},showCancelButton:!0,showConfirmButton:!0,autoAction:null,timeout:null,cfText:"我已支付",showImage:!0,qrCodeUrl:e.data.responseBody,closeAction:()=>{clearInterval(Y.value),Y.value=null}}):"alipay"===R.value&&(a.showConfirmDialog({title:"正在支付中...",message:"支付完成前请不要关闭此窗口。",confirmAction:()=>{},showCancelButton:!0,showConfirmButton:!0,autoAction:null,timeout:null,cfText:"我已支付",closeAction:()=>{clearInterval(Y.value),Y.value=null}}),window.open(e.data.responseBody,"_blank"))}var l}return t((async()=>{try{const a=await s();O.value=a.data,$(a.data[0])}catch(a){}})),(a,e)=>(n(),i(B,{class:"main-container"},{default:o((()=>[u(S,null,{default:o((()=>[u(q,{cols:"12",md:"8"},{default:o((()=>[u(d,null,{default:o((()=>[u(d,{class:"mb-4",elevation:"0"},{default:o((()=>[u(c,{class:"headline"},{default:o((()=>e[0]||(e[0]=[r("选择产品")]))),_:1}),u(m,{class:"mb-4"},{default:o((()=>[u(S,null,{default:o((()=>[(n(!0),v(p,null,f(O.value,(a=>(n(),i(q,{cols:"6",sm:"3",key:a.id},{default:o((()=>[u(d,{variant:X.value===a.id?"elevated":"tonal",class:"text-center mx-auto",color:(X.value,a.id,"primary"),onClick:e=>$(a),ripple:!1},{default:o((()=>[u(x,null,{default:o((()=>[u(z,null,{default:o((()=>[r(b(a.name+a.model),1)])),_:2},1024),Q.value.price?(n(),i(c,{key:0,class:"red--text"},{default:o((()=>[r(b(a.price.toFixed(2))+" 元",1)])),_:2},1024)):h("",!0),u(m,null,{default:o((()=>[r(b(a.description),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["variant","color","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),Q.value.price?(n(),i(x,{key:0,color:"primary"},{default:o((()=>[y("span",T,b(Q.value.name+"("+Q.value.model+")"),1),e[1]||(e[1]=r(" : ")),y("span",U,b(Q.value.price)+"元",1)])),_:1})):h("",!0)])),_:1}),u(d,{class:"mb-4",elevation:"0"},{default:o((()=>[u(c,{class:"headline"},{default:o((()=>e[2]||(e[2]=[r("选择付款方式")]))),_:1}),y("div",E,[(n(),v(p,null,f(L,(a=>u(d,{key:a.value,color:R.value===a.value?"primary":"grey",class:"ma-3 d-flex justify-space-between align-center",onClick:e=>R.value=a.value,ripple:!1,variant:"outlined",style:{"max-width":"500px","min-width":"300px","min-height":"55px",cursor:"pointer","padding-inline":"10px","border-radius":"6px"}},{default:o((()=>[y("div",M,[u(j,{color:R.value===a.value?"blue":"",class:"mr-2"},{default:o((()=>[r(b(R.value===a.value?"mdi-radiobox-marked":"mdi-radiobox-blank"),1)])),_:2},1032,["color"]),y("span",N,b(a.label),1)]),u(I,{src:a.image,height:"29",width:"84",class:"mr-0"},null,8,["src"])])),_:2},1032,["color","onClick"]))),64))]),u(_,{class:"ma-2"},{default:o((()=>[u(w,{size:"large",disabled:!W.value,variant:"elevated",style:{width:"260px",height:"50px","border-radius":"10px","font-size":"20px"},color:"blue-accent-4",onClick:aa},{default:o((()=>e[3]||(e[3]=[r(" 确认支付 ")]))),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1})])),_:1}),u(q,{cols:"12",md:"4"},{default:o((()=>[y("div",P,[u(d,{outlined:""},{default:o((()=>[u(c,{class:"headline mx-4 mb-10",style:{"font-size":"22px"}},{default:o((()=>e[4]||(e[4]=[r("订单信息")]))),_:1}),u(m,null,{default:o((()=>[y("div",V,[e[5]||(e[5]=y("div",{style:{"font-size":"20px"}},"产品",-1)),y("div",Z,b(Q.value.name),1)]),u(g,{class:"mx-4 mb-8"}),y("div",G,[e[6]||(e[6]=y("div",{style:{"font-size":"20px"}},"规格",-1)),y("div",H,b(Q.value.model),1)]),u(g,{class:"mx-4 mb-8"}),Q.value.price?(n(),v("div",J,[e[7]||(e[7]=y("div",{style:{"font-size":"20px"}},"订单金额",-1)),y("div",K,[y("strong",null,b(Q.value.price.toFixed(2))+"元 ",1)])])):h("",!0),u(g,{class:"mx-4 mb-4"})])),_:1})])),_:1})])])),_:1})])),_:1})])),_:1}))}},[["__scopeId","data-v-8331b7d5"]]);export{L as default};
