import{p as e,m as a,d as l,g as t,i as s,u as n,e as o,a as i,f as u,v as d,h as r,I as c,j as p,R as f,k as v,l as m,n as y,q as x,s as b,t as g,x as h,y as w,z as _,A as I,B as C,C as V,D as P,E as k,F as S,G as A,H as B,J as E,K as U,L as T,M as $,N as j,O as R,P as q,Q as D,S as L,T as O,U as M,W,X as z,Y as G,Z as N,_ as F,$ as H,a0 as J,a1 as K,a2 as Q,a3 as X,a4 as Y,c as Z,a5 as ee,a6 as ae,a7 as le,o as te,w as se,a8 as ne,a9 as oe,aa as ie,ab as ue,ac as de,ad as re,ae as ce,af as pe,ag as fe,ah as ve,ai as me,aj as ye,ak as xe,al as be,am as ge,an as he,ao as we,ap as _e,aq as Ie,ar as Ce,as as Ve,at as Pe,au as ke}from"./index-DlrOOw1b.js";import{V as Se,a as Ae,b as Be,c as Ee,w as Ue}from"./wechat_logo-B2QabQW4.js";const Te=Symbol.for("vuetify:v-expansion-panel"),$e=e({...a(),...l()},"VExpansionPanelText"),je=t()({name:"VExpansionPanelText",props:$e(),setup(e,a){let{slots:l}=a;const t=s(Te);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:c,onAfterLeave:p}=n(e,t.isSelected);return o((()=>i(r,{onAfterLeave:p},{default:()=>{var a;return[u(i("div",{class:["v-expansion-panel-text",e.class],style:e.style},[l.default&&c.value&&i("div",{class:"v-expansion-panel-text__wrapper"},[null==(a=l.default)?void 0:a.call(l)])]),[[d,t.isSelected.value]])]}}))),{}}}),Re=e({color:String,expandIcon:{type:c,default:"$expand"},collapseIcon:{type:c,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...a(),...p()},"VExpansionPanelTitle"),qe=t()({name:"VExpansionPanelTitle",directives:{Ripple:f},props:Re(),setup(e,a){let{slots:l}=a;const t=s(Te);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:n,backgroundColorStyles:d}=v(e,"color"),{dimensionStyles:r}=m(e),c=y((()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}))),p=y((()=>t.isSelected.value?e.collapseIcon:e.expandIcon));return o((()=>{var a;return u(i("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value,"v-expansion-panel-title--focusable":e.focusable,"v-expansion-panel-title--static":e.static},n.value,e.class],style:[d.value,r.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[i("span",{class:"v-expansion-panel-title__overlay"},null),null==(a=l.default)?void 0:a.call(l,c.value),!e.hideActions&&i(b,{defaults:{VIcon:{icon:p.value}}},{default:()=>{var e;return[i("span",{class:"v-expansion-panel-title__icon"},[(null==(e=l.actions)?void 0:e.call(l,c.value))??i(g,null,null)])]}})]),[[x("ripple"),e.ripple]])})),{}}}),De=e({title:String,text:String,bgColor:String,...h(),...w(),..._(),...I(),...Re(),...$e()},"VExpansionPanel"),Le=t()({name:"VExpansionPanel",props:De(),emits:{"group:selected":e=>!0},setup(e,a){let{slots:l}=a;const t=C(e,Te),{backgroundColorClasses:s,backgroundColorStyles:n}=v(e,"bgColor"),{elevationClasses:u}=V(e),{roundedClasses:d}=P(e),r=y((()=>(null==t?void 0:t.disabled.value)||e.disabled)),c=y((()=>t.group.items.value.reduce(((e,a,l)=>(t.group.selected.value.includes(a.id)&&e.push(l),e)),[]))),p=y((()=>{const e=t.group.items.value.findIndex((e=>e.id===t.id));return!t.isSelected.value&&c.value.some((a=>a-e==1))})),f=y((()=>{const e=t.group.items.value.findIndex((e=>e.id===t.id));return!t.isSelected.value&&c.value.some((a=>a-e==-1))}));return k(Te,t),o((()=>{const a=!(!l.text&&!e.text),o=!(!l.title&&!e.title),c=qe.filterProps(e),v=je.filterProps(e);return i(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":p.value,"v-expansion-panel--after-active":f.value,"v-expansion-panel--disabled":r.value},d.value,s.value,e.class],style:[n.value,e.style]},{default:()=>[i("div",{class:["v-expansion-panel__shadow",...u.value]},null),i(b,{defaults:{VExpansionPanelTitle:{...c},VExpansionPanelText:{...v}}},{default:()=>{var t;return[o&&i(qe,{key:"title"},{default:()=>[l.title?l.title():e.title]}),a&&i(je,{key:"text"},{default:()=>[l.text?l.text():e.text]}),null==(t=l.default)?void 0:t.call(l)]}})]})})),{groupItem:t}}}),Oe=["default","accordion","inset","popout"],Me=e({flat:Boolean,...S(),...A(De(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...B(),...a(),...I(),variant:{type:String,default:"default",validator:e=>Oe.includes(e)}},"VExpansionPanels"),We=t()({name:"VExpansionPanels",props:Me(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:l}=a;const{next:t,prev:s}=E(e,Te),{themeClasses:n}=U(e),u=y((()=>e.variant&&`v-expansion-panels--variant-${e.variant}`));return T({VExpansionPanel:{bgColor:$(e,"bgColor"),collapseIcon:$(e,"collapseIcon"),color:$(e,"color"),eager:$(e,"eager"),elevation:$(e,"elevation"),expandIcon:$(e,"expandIcon"),focusable:$(e,"focusable"),hideActions:$(e,"hideActions"),readonly:$(e,"readonly"),ripple:$(e,"ripple"),rounded:$(e,"rounded"),static:$(e,"static")}}),o((()=>i(e.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":e.flat,"v-expansion-panels--tile":e.tile},n.value,u.value,e.class],style:e.style},{default:()=>{var e;return[null==(e=l.default)?void 0:e.call(l,{prev:s,next:t})]}}))),{next:t,prev:s}}}),ze=e({...j({falseIcon:"$radioOff",trueIcon:"$radioOn"})},"VRadio"),Ge=t()({name:"VRadio",props:ze(),setup(e,a){let{slots:l}=a;return o((()=>{const a=R.filterProps(e);return i(R,q(a,{class:["v-radio",e.class],style:e.style,type:"radio"}),l)})),{}}}),Ne=e({height:{type:[Number,String],default:"auto"},...D(),...L(O(),["multiple"]),trueIcon:{type:c,default:"$radioOn"},falseIcon:{type:c,default:"$radioOff"},type:{type:String,default:"radio"}},"VRadioGroup"),Fe=t()({name:"VRadioGroup",inheritAttrs:!1,props:Ne(),emits:{"update:modelValue":e=>!0},setup(e,a){let{attrs:l,slots:t}=a;const s=M(),n=y((()=>e.id||`radio-group-${s}`)),u=W(e,"modelValue");return o((()=>{const[a,s]=z(l),o=G.filterProps(e),d=R.filterProps(e),r=t.label?t.label({label:e.label,props:{for:n.value}}):e.label;return i(G,q({class:["v-radio-group",e.class],style:e.style},a,o,{modelValue:u.value,"onUpdate:modelValue":e=>u.value=e,id:n.value}),{...t,default:a=>{let{id:l,messagesId:n,isDisabled:o,isReadonly:c}=a;return i(N,null,[r&&i(F,{id:l.value},{default:()=>[r]}),i(H,q(d,{id:l.value,"aria-describedby":n.value,defaultsTarget:"VRadio",trueIcon:e.trueIcon,falseIcon:e.falseIcon,type:e.type,disabled:o.value,readonly:c.value,"aria-labelledby":r?l.value:void 0,multiple:!1},s,{modelValue:u.value,"onUpdate:modelValue":e=>u.value=e}),t)])}})})),{}}}),He={key:0},Je={class:"d-flex flex-wrap"},Ke={class:"d-flex align-center",style:{flex:"1"}},Qe={style:{"min-width":"100px"}},Xe={__name:"index",setup(e){const a=J();let l=ee().query.from||"/user/";const t=K([]),s=K("alipay"),n=K(!0),o=K(null),u=ae(),d=K({}),c=K("");K(!1);const p=K(!1),f=K(!1);K(!1);const v=[{label:"支付宝",value:"alipay",image:Ee},{label:"微信支付",value:"wechat",image:Ue}];K(!0);const m=K("2024-12-31"),y=["仅会员可见文章","密记服务","AI助手 ai-chat"],x=Q({oldPassword:"",newPassword:"",confirmPassword:""}),b=()=>{f.value=!f.value};X((()=>{!async function(){try{const e=await le();if("login"===e.msg){if(a.isAuthenticated=!0,a.userInfo=e.data,a.userInfo.city&&a.userInfo.city.length>0){const e=a.userInfo.city;if(e.length>=6){const l=e.substring(0,2),t=e.substring(0,4);a.userInfo.selectedLocation={province:l,city:t,county:e}}else if(e.length>=4){const l=e.substring(0,2);a.userInfo.selectedLocation={province:l,city:e}}else a.userInfo.selectedLocation={province:e}}}else"/login"!==u.currentRoute.value.path&&(l?u.push({path:"/login",query:{from:l}}):u.push({path:"/login"}))}catch(e){}}()}));const h=async()=>{await we({nickname:a.userInfo.nickname})},w=async()=>{if(!x.oldPassword||!x.newPassword||x.newPassword.length<6)return void alert("密码不能为空 且长度不低于6位");if(x.newPassword!==x.confirmPassword)return void alert("新密码与确认密码不一致");if(x.newPassword==x.oldPassword)return void alert("新密码与旧密码一致");const e=await _e({oldPassword:x.oldPassword,newPassword:x.newPassword});if(e.success){const e=Ie();e.showConfirmDialog({title:"成功",message:"密码更新成功",confirmAction:()=>{},showCancelButton:!1,showConfirmButton:!1,autoAction:()=>{e.handleCancel()},timeout:1e3,closeAction:()=>{}})}else{const a=Ie();a.showConfirmDialog({title:"失败",message:e.msg,confirmAction:()=>{},showCancelButton:!1,showConfirmButton:!1,autoAction:()=>{a.handleCancel()},timeout:1e3,closeAction:()=>{}})}p.value=!1};async function _(){const e=d.value,l=await Ce({paymentMethod:s.value,orderName:e.name,isWeChat:a.isWeChat?1:0,returnUrl:"https://sntree.cn/user",quitUrl:"https://sntree.cn/user",fromUrl:"https://sntree.cn/user",deviceType:a.isMobile?"mobile":"pc",items:[{productId:e.id,productCode:e.productCode,quantity:1}]});if(l.success){const e=Ie();t=l.data.order_id,o.value=setInterval((async()=>{const e=await ke(t);e.success&&"SUCCESS"===e.data&&(Ie().handleCancel(),clearInterval(o.value),o.value=null)}),5e3),"wechat"===s.value?a.isMobile&&!a.isWeChat?window.location.href=l.data.responseBody:e.showConfirmDialog({title:"扫码支付",message:"请使用微信扫码完成支付",confirmAction:()=>{},showCancelButton:!0,showConfirmButton:!0,autoAction:null,timeout:null,cfText:"我已支付",showImage:!0,qrCodeUrl:l.data.responseBody,closeAction:()=>{clearInterval(o.value),o.value=null}}):"alipay"===s.value&&(a.isMobile||e.showConfirmDialog({title:"正在支付中...",message:"支付完成前请不要关闭此窗口。",confirmAction:()=>{},showCancelButton:!0,showConfirmButton:!0,autoAction:null,timeout:null,cfText:"我已支付",closeAction:()=>{clearInterval(o.value),o.value=null}}),window.location.href=l.data.responseBody)}var t}function I(e){d.value=e,c.value=e.id}return X((async()=>{try{const e=await Y();t.value=e.data,I(e.data[0])}catch(e){}})),(e,l)=>(te(),Z(Be,{class:"py-4",style:{"max-width":"792px"}},{default:se((()=>[i(he,{class:"mb-4",density:"compact"},{default:se((()=>[i(ne,{class:"d-flex justify-space-between align-center"},{default:se((()=>[oe("div",null,[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[5]||(l[5]=[ie("mdi-account-circle")]))),_:1}),l[6]||(l[6]=ie(" 用户信息 "))]),i(ue,{variant:"text","prepend-icon":"mdi-receipt-outline",to:"/orders"},{default:se((()=>l[7]||(l[7]=[ie(" 订单记录 ")]))),_:1})])),_:1}),i(de,null,{default:se((()=>[i(Se,null,{default:se((()=>[i(Ae,{cols:"12",md:"6"},{default:se((()=>[l[8]||(l[8]=oe("strong",null,"用户名:",-1)),ie(" "+re(ce(a).userInfo.nickname),1)])),_:1}),i(Ae,{cols:"12",md:"6"},{default:se((()=>[l[9]||(l[9]=oe("strong",null,"账号:",-1)),ie(" "+re(ce(a).userInfo.phone),1)])),_:1})])),_:1})])),_:1}),i(We,{variant:"accordion",multiple:""},{default:se((()=>[i(Le,null,{default:se((()=>[i(qe,null,{default:se((()=>l[10]||(l[10]=[ie(" 会员订阅 ")]))),_:1}),i(je,null,{default:se((()=>[i(ne,null,{default:se((()=>[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[11]||(l[11]=[ie("mdi-account-star")]))),_:1}),l[12]||(l[12]=ie(" 会员状态 "))])),_:1}),i(de,null,{default:se((()=>[i(Se,null,{default:se((()=>[i(Ae,{cols:"12",md:"6"},{default:se((()=>[l[13]||(l[13]=oe("strong",null,"当前状态:",-1)),oe("span",{class:pe({"text-success":ce(a).userInfo.member,"text-error":!ce(a).userInfo.member})},re(ce(a).userInfo.member?"已开通":"未开通"),3)])),_:1}),i(Ae,{cols:"12",md:"6"},{default:se((()=>[l[14]||(l[14]=oe("strong",null,"到期时间:",-1)),ie(" "+re(ce(a).userInfo.member?m.value:"暂无"),1)])),_:1})])),_:1}),i(fe,{class:"my-4"}),i(Se,null,{default:se((()=>[i(Ae,{cols:"12"},{default:se((()=>[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[15]||(l[15]=[ie("mdi-diamond")]))),_:1}),l[16]||(l[16]=oe("strong",null,"会员特权:",-1))])),_:1}),(te(),ve(N,null,me(y,((e,a)=>i(Ae,{key:a,cols:"6",md:"4"},{default:se((()=>[i(Ve,{variant:"flat",color:"amber",dark:""},{default:se((()=>[ie(re(e),1)])),_:2},1024)])),_:2},1024))),64))])),_:1})])),_:1}),i(ye,null,{default:se((()=>[i(ue,{variant:"elevated",color:"black",onClick:b,class:"ml-2"},{default:se((()=>l[17]||(l[17]=[ie("开通/续费会员")]))),_:1})])),_:1}),i(r,null,{default:se((()=>[f.value?(te(),ve("div",He,[i(ne,null,{default:se((()=>[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[18]||(l[18]=[ie("mdi-cash")]))),_:1}),l[19]||(l[19]=ie(" 开通/续费会员 "))])),_:1}),i(de,null,{default:se((()=>[i(Fe,{modelValue:d.value.id,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value.id=e),class:"mb-3"},{default:se((()=>[(te(!0),ve(N,null,me(t.value,((e,a)=>(te(),Z(Ge,{key:a,label:`${e.name} - ￥${e.price}/月`,value:e.id,onClick:a=>I(e)},null,8,["label","value","onClick"])))),128))])),_:1},8,["modelValue"]),oe("div",Je,[(te(),ve(N,null,me(v,(e=>i(he,{density:"compact",key:e.value,color:s.value===e.value?"primary":"grey",class:"ma-3 ml-0 mr-6 d-flex justify-space-between align-center",onClick:a=>s.value=e.value,ripple:!1,variant:"outlined",style:{"max-width":"500px","min-width":"280px","min-height":"55px",cursor:"pointer","padding-inline":"10px","border-radius":"6px"}},{default:se((()=>[oe("div",Ke,[i(g,{color:s.value===e.value?"blue":"",class:"mr-2"},{default:se((()=>[ie(re(s.value===e.value?"mdi-radiobox-marked":"mdi-radiobox-blank"),1)])),_:2},1032,["color"]),oe("span",Qe,re(e.label),1)]),i(Pe,{src:e.image,height:"29",width:"84",class:"mr-0"},null,8,["src"])])),_:2},1032,["color","onClick"]))),64))])])),_:1}),i(ye,{class:"ml-2 d-flex",style:{"flex-wrap":"wrap"}},{default:se((()=>[i(ue,{size:"large",disabled:!n.value,variant:"elevated",style:{width:"260px",height:"50px","border-radius":"10px","font-size":"20px"},color:"blue-accent-4",onClick:_},{default:se((()=>l[20]||(l[20]=[ie(" 确认支付 ")]))),_:1},8,["disabled"]),i(ue,{color:"grey",onClick:b},{default:se((()=>l[21]||(l[21]=[ie("取消")]))),_:1})])),_:1})])):xe("",!0)])),_:1})])),_:1})])),_:1}),i(Le,null,{default:se((()=>[i(qe,null,{default:se((()=>l[22]||(l[22]=[ie(" 账号设置 ")]))),_:1}),i(je,null,{default:se((()=>[i(ne,null,{default:se((()=>[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[23]||(l[23]=[ie("mdi-card-account-details-outline")]))),_:1}),l[24]||(l[24]=ie(" 用户信息 "))])),_:1}),i(de,null,{default:se((()=>[i(Se,null,{default:se((()=>[i(Ae,{cols:"12",md:"6"},{default:se((()=>[i(be,{"prepend-icon":"mdi-text-account",density:"compact",variant:"outlined",modelValue:ce(a).userInfo.nickname,"onUpdate:modelValue":l[1]||(l[1]=e=>ce(a).userInfo.nickname=e),label:"用户昵称",outlined:""},null,8,["modelValue"])])),_:1})])),_:1}),i(Se,{justify:"end",class:"mb-1 mr-2"},{default:se((()=>[i(ue,{color:"primary",onClick:h},{default:se((()=>l[25]||(l[25]=[ie("保存信息")]))),_:1})])),_:1})])),_:1}),i(fe),i(ne,null,{default:se((()=>[i(g,{class:"mr-2",color:"primary"},{default:se((()=>l[26]||(l[26]=[ie("mdi-key")]))),_:1}),l[27]||(l[27]=ie(" 修改密码 "))])),_:1}),i(de,null,{default:se((()=>[i(ge,null,{default:se((()=>[i(Se,null,{default:se((()=>[i(Ae,{cols:"12"},{default:se((()=>[l[28]||(l[28]=oe("div",{class:"text-subtitle-1 text-medium-emphasis"},"旧密码",-1)),i(be,{modelValue:x.oldPassword,"onUpdate:modelValue":l[2]||(l[2]=e=>x.oldPassword=e),density:"compact",variant:"outlined",type:"password",placeholder:"旧密码"},null,8,["modelValue"])])),_:1}),i(Ae,{cols:"12",style:{"margin-top":"-36px"}},{default:se((()=>[l[29]||(l[29]=oe("div",{class:"text-subtitle-1 text-medium-emphasis"},"新密码",-1)),i(be,{modelValue:x.newPassword,"onUpdate:modelValue":l[3]||(l[3]=e=>x.newPassword=e),type:"password",density:"compact",placeholder:"新密码",variant:"outlined"},null,8,["modelValue"])])),_:1}),i(Ae,{cols:"12",style:{"margin-top":"-36px"}},{default:se((()=>[l[30]||(l[30]=oe("div",{class:"text-subtitle-1 text-medium-emphasis"},"确认新密码",-1)),i(be,{modelValue:x.confirmPassword,"onUpdate:modelValue":l[4]||(l[4]=e=>x.confirmPassword=e),placeholder:"确认新密码",type:"password",density:"compact",variant:"outlined"},null,8,["modelValue"])])),_:1})])),_:1}),i(Se,{justify:"end",class:"mb-1 mr-2"},{default:se((()=>[i(ue,{color:"primary",onClick:w},{default:se((()=>l[31]||(l[31]=[ie("修改密码")]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}};export{Xe as default};
